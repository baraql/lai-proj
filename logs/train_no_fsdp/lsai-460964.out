START TIME: Fri May 23 18:14:22 CEST 2025
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-23 18:14:43,694 - root - INFO - Setting seed to 42
2025-05-23 18:14:43,695 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=5e-05, lr_warmup_steps=100, training_steps=100, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, scaling_factor=8, scaling_strategy=<ScalingStrategy.ALL: 'all'>, set_seed=42)
2025-05-23 18:14:43,695 - root - INFO - Setting up DataLoaders...
2025-05-23 18:14:47,109 - root - INFO - Setting up Model...
2025-05-23 18:14:47,109 - root - INFO - Loading a model with scale=8, scaling_strategy=ScalingStrategy.ALL, config:
TransformerModelArgs(dim=2048, n_layers=64, n_heads=64, n_kv_heads=8, multiple_of=256, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, norm_type='rmsnorm', seq_len=4096, vocab_size=131072)
2025-05-23 18:15:06,165 - root - INFO - Total model parameters: 3,959,687,168
2025-05-23 18:15:06,168 - root - INFO - Starting training!
2025-05-23 18:15:07,815 - root - INFO - Step: 1 | Loss: 11.94 | Tokens per second: 2490.85 | Training tokens per second (%): 19.38 | MFU (%): 7.20 | TFLOPs: 71.21
2025-05-23 18:15:09,448 - root - INFO - Step: 5 | Loss: 11.92 | Tokens per second: 10051.03 | Training tokens per second (%): 11.41 | MFU (%): 29.06 | TFLOPs: 287.36
2025-05-23 18:15:11,444 - root - INFO - Step: 10 | Loss: 11.92 | Tokens per second: 10275.67 | Training tokens per second (%): 25.72 | MFU (%): 29.70 | TFLOPs: 293.78
2025-05-23 18:15:13,470 - root - INFO - Step: 15 | Loss: 11.78 | Tokens per second: 10125.76 | Training tokens per second (%): 35.21 | MFU (%): 29.27 | TFLOPs: 289.50
2025-05-23 18:15:15,486 - root - INFO - Step: 20 | Loss: 11.67 | Tokens per second: 10175.45 | Training tokens per second (%): 34.78 | MFU (%): 29.42 | TFLOPs: 290.92
2025-05-23 18:15:17,618 - root - INFO - Step: 25 | Loss: 11.25 | Tokens per second: 9617.18 | Training tokens per second (%): 18.28 | MFU (%): 27.80 | TFLOPs: 274.95
2025-05-23 18:15:19,621 - root - INFO - Step: 30 | Loss: 10.62 | Tokens per second: 10239.97 | Training tokens per second (%): 26.99 | MFU (%): 29.60 | TFLOPs: 292.76
2025-05-23 18:15:21,593 - root - INFO - Step: 35 | Loss: 10.54 | Tokens per second: 10398.34 | Training tokens per second (%): 13.78 | MFU (%): 30.06 | TFLOPs: 297.29
2025-05-23 18:15:23,580 - root - INFO - Step: 40 | Loss: 10.55 | Tokens per second: 10321.47 | Training tokens per second (%): 9.95 | MFU (%): 29.84 | TFLOPs: 295.09
2025-05-23 18:15:25,567 - root - INFO - Step: 45 | Loss: 9.97 | Tokens per second: 10321.48 | Training tokens per second (%): 15.59 | MFU (%): 29.84 | TFLOPs: 295.09
2025-05-23 18:15:27,547 - root - INFO - Step: 50 | Loss: 9.93 | Tokens per second: 10360.10 | Training tokens per second (%): 10.93 | MFU (%): 29.95 | TFLOPs: 296.19
2025-05-23 18:15:29,547 - root - INFO - Step: 55 | Loss: 10.29 | Tokens per second: 10253.12 | Training tokens per second (%): 28.32 | MFU (%): 29.64 | TFLOPs: 293.14
2025-05-23 18:15:31,547 - root - INFO - Step: 60 | Loss: 9.68 | Tokens per second: 10257.98 | Training tokens per second (%): 26.71 | MFU (%): 29.65 | TFLOPs: 293.28
2025-05-23 18:15:33,545 - root - INFO - Step: 65 | Loss: 9.86 | Tokens per second: 10266.19 | Training tokens per second (%): 24.18 | MFU (%): 29.68 | TFLOPs: 293.51
2025-05-23 18:15:35,563 - root - INFO - Step: 70 | Loss: 9.48 | Tokens per second: 10160.69 | Training tokens per second (%): 26.25 | MFU (%): 29.37 | TFLOPs: 290.49
2025-05-23 18:15:37,560 - root - INFO - Step: 75 | Loss: 9.11 | Tokens per second: 10270.88 | Training tokens per second (%): 16.89 | MFU (%): 29.69 | TFLOPs: 293.64
2025-05-23 18:15:39,634 - root - INFO - Step: 80 | Loss: 9.00 | Tokens per second: 9886.50 | Training tokens per second (%): 17.36 | MFU (%): 28.58 | TFLOPs: 282.65
2025-05-23 18:15:41,617 - root - INFO - Step: 85 | Loss: 9.11 | Tokens per second: 10346.62 | Training tokens per second (%): 16.04 | MFU (%): 29.91 | TFLOPs: 295.81
2025-05-23 18:15:43,682 - root - INFO - Step: 90 | Loss: 8.53 | Tokens per second: 9931.17 | Training tokens per second (%): 57.98 | MFU (%): 28.71 | TFLOPs: 283.93
2025-05-23 18:15:45,745 - root - INFO - Step: 95 | Loss: 8.14 | Tokens per second: 9938.41 | Training tokens per second (%): 57.90 | MFU (%): 28.73 | TFLOPs: 284.14
2025-05-23 18:15:47,872 - root - INFO - Step: 100 | Loss: 8.06 | Tokens per second: 9643.71 | Training tokens per second (%): 93.89 | MFU (%): 27.88 | TFLOPs: 275.71
2025-05-23 18:15:47,872 - root - INFO - Training completed
END TIME: Fri May 23 18:15:49 CEST 2025
