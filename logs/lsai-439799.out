START TIME: Wed May 14 15:18:04 CEST 2025
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-14 15:18:25,731 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=5e-05, lr_warmup_steps=100, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False)
2025-05-14 15:18:25,731 - root - INFO - Setting up DataLoaders...
2025-05-14 15:18:28,860 - root - INFO - Setting up Model...
2025-05-14 15:19:06,208 - root - INFO - Starting training!
2025-05-14 15:19:07,761 - root - INFO - Step: 1 | Loss: 12.00 | Tokens per second: 2707.53 | Training tokens per second (%): 19.38 | MFU (%): 14.11 | TFLOPs: 139.55
2025-05-14 15:19:09,934 - root - INFO - Step: 5 | Loss: 11.93 | Tokens per second: 7687.60 | Training tokens per second (%): 11.41 | MFU (%): 40.06 | TFLOPs: 396.23
2025-05-14 15:19:12,697 - root - INFO - Step: 10 | Loss: 11.90 | Tokens per second: 7522.76 | Training tokens per second (%): 25.72 | MFU (%): 39.20 | TFLOPs: 387.73
2025-05-14 15:19:15,495 - root - INFO - Step: 15 | Loss: 11.72 | Tokens per second: 7429.73 | Training tokens per second (%): 35.21 | MFU (%): 38.72 | TFLOPs: 382.94
2025-05-14 15:19:18,297 - root - INFO - Step: 20 | Loss: 11.34 | Tokens per second: 7415.57 | Training tokens per second (%): 34.78 | MFU (%): 38.65 | TFLOPs: 382.21
2025-05-14 15:19:21,034 - root - INFO - Step: 25 | Loss: 10.84 | Tokens per second: 7597.52 | Training tokens per second (%): 18.28 | MFU (%): 39.59 | TFLOPs: 391.59
2025-05-14 15:19:23,813 - root - INFO - Step: 30 | Loss: 9.81 | Tokens per second: 7479.00 | Training tokens per second (%): 26.99 | MFU (%): 38.98 | TFLOPs: 385.48
2025-05-14 15:19:26,541 - root - INFO - Step: 35 | Loss: 9.83 | Tokens per second: 7623.52 | Training tokens per second (%): 13.78 | MFU (%): 39.73 | TFLOPs: 392.93
2025-05-14 15:19:29,245 - root - INFO - Step: 40 | Loss: 9.88 | Tokens per second: 7691.00 | Training tokens per second (%): 9.95 | MFU (%): 40.08 | TFLOPs: 396.40
2025-05-14 15:19:31,978 - root - INFO - Step: 45 | Loss: 9.25 | Tokens per second: 7606.02 | Training tokens per second (%): 15.59 | MFU (%): 39.64 | TFLOPs: 392.02
2025-05-14 15:19:34,694 - root - INFO - Step: 50 | Loss: 9.18 | Tokens per second: 7657.48 | Training tokens per second (%): 10.93 | MFU (%): 39.91 | TFLOPs: 394.68
2025-05-14 15:19:37,476 - root - INFO - Step: 55 | Loss: 9.40 | Tokens per second: 7470.36 | Training tokens per second (%): 28.32 | MFU (%): 38.93 | TFLOPs: 385.03
2025-05-14 15:19:40,242 - root - INFO - Step: 60 | Loss: 8.71 | Tokens per second: 7518.15 | Training tokens per second (%): 26.71 | MFU (%): 39.18 | TFLOPs: 387.49
2025-05-14 15:19:43,009 - root - INFO - Step: 65 | Loss: 8.96 | Tokens per second: 7511.34 | Training tokens per second (%): 24.18 | MFU (%): 39.14 | TFLOPs: 387.14
2025-05-14 15:19:45,777 - root - INFO - Step: 70 | Loss: 8.30 | Tokens per second: 7510.03 | Training tokens per second (%): 26.25 | MFU (%): 39.14 | TFLOPs: 387.08
2025-05-14 15:19:48,514 - root - INFO - Step: 75 | Loss: 8.36 | Tokens per second: 7596.57 | Training tokens per second (%): 16.89 | MFU (%): 39.59 | TFLOPs: 391.54
2025-05-14 15:19:51,252 - root - INFO - Step: 80 | Loss: 8.30 | Tokens per second: 7593.54 | Training tokens per second (%): 17.36 | MFU (%): 39.57 | TFLOPs: 391.38
2025-05-14 15:19:53,984 - root - INFO - Step: 85 | Loss: 8.35 | Tokens per second: 7610.78 | Training tokens per second (%): 16.04 | MFU (%): 39.66 | TFLOPs: 392.27
2025-05-14 15:19:56,884 - root - INFO - Step: 90 | Loss: 7.82 | Tokens per second: 7162.46 | Training tokens per second (%): 57.98 | MFU (%): 37.33 | TFLOPs: 369.16
2025-05-14 15:19:59,775 - root - INFO - Step: 95 | Loss: 7.50 | Tokens per second: 7187.00 | Training tokens per second (%): 57.90 | MFU (%): 37.45 | TFLOPs: 370.43
2025-05-14 15:20:02,782 - root - INFO - Step: 100 | Loss: 7.47 | Tokens per second: 6904.40 | Training tokens per second (%): 93.89 | MFU (%): 35.98 | TFLOPs: 355.86
2025-05-14 15:20:05,520 - root - INFO - Step: 105 | Loss: 7.74 | Tokens per second: 7594.03 | Training tokens per second (%): 17.91 | MFU (%): 39.58 | TFLOPs: 391.41
2025-05-14 15:20:08,291 - root - INFO - Step: 110 | Loss: 8.32 | Tokens per second: 7502.78 | Training tokens per second (%): 25.76 | MFU (%): 39.10 | TFLOPs: 386.70
2025-05-14 15:20:11,001 - root - INFO - Step: 115 | Loss: 7.71 | Tokens per second: 7673.33 | Training tokens per second (%): 9.98 | MFU (%): 39.99 | TFLOPs: 395.49
2025-05-14 15:20:13,781 - root - INFO - Step: 120 | Loss: 7.86 | Tokens per second: 7476.78 | Training tokens per second (%): 26.43 | MFU (%): 38.96 | TFLOPs: 385.36
2025-05-14 15:20:16,546 - root - INFO - Step: 125 | Loss: 8.14 | Tokens per second: 7518.59 | Training tokens per second (%): 24.73 | MFU (%): 39.18 | TFLOPs: 387.52
2025-05-14 15:20:19,297 - root - INFO - Step: 130 | Loss: 8.72 | Tokens per second: 7555.58 | Training tokens per second (%): 17.81 | MFU (%): 39.38 | TFLOPs: 389.42
2025-05-14 15:20:22,050 - root - INFO - Step: 135 | Loss: 7.74 | Tokens per second: 7553.37 | Training tokens per second (%): 21.95 | MFU (%): 39.36 | TFLOPs: 389.31
2025-05-14 15:20:24,768 - root - INFO - Step: 140 | Loss: 7.40 | Tokens per second: 7649.35 | Training tokens per second (%): 11.89 | MFU (%): 39.86 | TFLOPs: 394.26
2025-05-14 15:20:27,549 - root - INFO - Step: 145 | Loss: 7.52 | Tokens per second: 7474.35 | Training tokens per second (%): 26.10 | MFU (%): 38.95 | TFLOPs: 385.24
2025-05-14 15:20:30,301 - root - INFO - Step: 150 | Loss: 7.85 | Tokens per second: 7555.82 | Training tokens per second (%): 19.74 | MFU (%): 39.38 | TFLOPs: 389.44
2025-05-14 15:20:33,125 - root - INFO - Step: 155 | Loss: 7.32 | Tokens per second: 7358.05 | Training tokens per second (%): 37.10 | MFU (%): 38.35 | TFLOPs: 379.24
2025-05-14 15:20:35,882 - root - INFO - Step: 160 | Loss: 6.84 | Tokens per second: 7540.07 | Training tokens per second (%): 22.84 | MFU (%): 39.29 | TFLOPs: 388.62
2025-05-14 15:20:38,652 - root - INFO - Step: 165 | Loss: 7.14 | Tokens per second: 7505.91 | Training tokens per second (%): 26.44 | MFU (%): 39.12 | TFLOPs: 386.86
2025-05-14 15:20:41,474 - root - INFO - Step: 170 | Loss: 7.86 | Tokens per second: 7362.89 | Training tokens per second (%): 39.34 | MFU (%): 38.37 | TFLOPs: 379.49
2025-05-14 15:20:44,221 - root - INFO - Step: 175 | Loss: 7.52 | Tokens per second: 7568.31 | Training tokens per second (%): 19.59 | MFU (%): 39.44 | TFLOPs: 390.08
2025-05-14 15:20:46,956 - root - INFO - Step: 180 | Loss: 7.04 | Tokens per second: 7602.35 | Training tokens per second (%): 14.69 | MFU (%): 39.62 | TFLOPs: 391.83
2025-05-14 15:20:49,682 - root - INFO - Step: 185 | Loss: 7.65 | Tokens per second: 7627.18 | Training tokens per second (%): 13.71 | MFU (%): 39.75 | TFLOPs: 393.11
2025-05-14 15:20:52,442 - root - INFO - Step: 190 | Loss: 7.29 | Tokens per second: 7532.24 | Training tokens per second (%): 21.21 | MFU (%): 39.25 | TFLOPs: 388.22
2025-05-14 15:20:55,269 - root - INFO - Step: 195 | Loss: 7.56 | Tokens per second: 7351.49 | Training tokens per second (%): 42.67 | MFU (%): 38.31 | TFLOPs: 378.90
2025-05-14 15:20:58,015 - root - INFO - Step: 200 | Loss: 7.96 | Tokens per second: 7572.20 | Training tokens per second (%): 16.92 | MFU (%): 39.46 | TFLOPs: 390.28
2025-05-14 15:21:00,724 - root - INFO - Step: 205 | Loss: 6.98 | Tokens per second: 7676.89 | Training tokens per second (%): 9.70 | MFU (%): 40.01 | TFLOPs: 395.68
2025-05-14 15:21:03,474 - root - INFO - Step: 210 | Loss: 7.37 | Tokens per second: 7559.29 | Training tokens per second (%): 19.35 | MFU (%): 39.39 | TFLOPs: 389.61
2025-05-14 15:21:06,198 - root - INFO - Step: 215 | Loss: 7.16 | Tokens per second: 7633.86 | Training tokens per second (%): 12.01 | MFU (%): 39.78 | TFLOPs: 393.46
2025-05-14 15:21:08,912 - root - INFO - Step: 220 | Loss: 7.42 | Tokens per second: 7659.60 | Training tokens per second (%): 12.01 | MFU (%): 39.92 | TFLOPs: 394.78
2025-05-14 15:21:11,690 - root - INFO - Step: 225 | Loss: 7.21 | Tokens per second: 7483.48 | Training tokens per second (%): 25.42 | MFU (%): 39.00 | TFLOPs: 385.71
2025-05-14 15:21:14,394 - root - INFO - Step: 230 | Loss: 7.28 | Tokens per second: 7689.20 | Training tokens per second (%): 6.27 | MFU (%): 40.07 | TFLOPs: 396.31
2025-05-14 15:21:17,117 - root - INFO - Step: 235 | Loss: 7.56 | Tokens per second: 7637.09 | Training tokens per second (%): 13.84 | MFU (%): 39.80 | TFLOPs: 393.62
2025-05-14 15:21:19,901 - root - INFO - Step: 240 | Loss: 6.84 | Tokens per second: 7467.72 | Training tokens per second (%): 28.71 | MFU (%): 38.92 | TFLOPs: 384.90
2025-05-14 15:21:22,697 - root - INFO - Step: 245 | Loss: 7.11 | Tokens per second: 7433.06 | Training tokens per second (%): 31.89 | MFU (%): 38.74 | TFLOPs: 383.11
2025-05-14 15:21:25,514 - root - INFO - Step: 250 | Loss: 7.35 | Tokens per second: 7378.13 | Training tokens per second (%): 35.94 | MFU (%): 38.45 | TFLOPs: 380.28
2025-05-14 15:21:28,237 - root - INFO - Step: 255 | Loss: 7.97 | Tokens per second: 7636.18 | Training tokens per second (%): 11.16 | MFU (%): 39.80 | TFLOPs: 393.58
2025-05-14 15:21:31,025 - root - INFO - Step: 260 | Loss: 8.43 | Tokens per second: 7455.60 | Training tokens per second (%): 30.02 | MFU (%): 38.85 | TFLOPs: 384.27
2025-05-14 15:21:33,758 - root - INFO - Step: 265 | Loss: 7.19 | Tokens per second: 7605.50 | Training tokens per second (%): 12.67 | MFU (%): 39.64 | TFLOPs: 392.00
2025-05-14 15:21:36,504 - root - INFO - Step: 270 | Loss: 7.11 | Tokens per second: 7571.57 | Training tokens per second (%): 17.27 | MFU (%): 39.46 | TFLOPs: 390.25
2025-05-14 15:21:39,237 - root - INFO - Step: 275 | Loss: 7.17 | Tokens per second: 7607.07 | Training tokens per second (%): 13.21 | MFU (%): 39.64 | TFLOPs: 392.08
2025-05-14 15:21:42,020 - root - INFO - Step: 280 | Loss: 6.86 | Tokens per second: 7469.56 | Training tokens per second (%): 27.62 | MFU (%): 38.93 | TFLOPs: 384.99
2025-05-14 15:21:44,784 - root - INFO - Step: 285 | Loss: 7.54 | Tokens per second: 7521.22 | Training tokens per second (%): 21.59 | MFU (%): 39.20 | TFLOPs: 387.65
2025-05-14 15:21:47,513 - root - INFO - Step: 290 | Loss: 6.82 | Tokens per second: 7620.48 | Training tokens per second (%): 13.66 | MFU (%): 39.71 | TFLOPs: 392.77
2025-05-14 15:21:50,236 - root - INFO - Step: 295 | Loss: 6.83 | Tokens per second: 7636.24 | Training tokens per second (%): 11.15 | MFU (%): 39.80 | TFLOPs: 393.58
2025-05-14 15:21:53,118 - root - INFO - Step: 300 | Loss: 6.57 | Tokens per second: 7207.34 | Training tokens per second (%): 54.36 | MFU (%): 37.56 | TFLOPs: 371.48
2025-05-14 15:21:55,879 - root - INFO - Step: 305 | Loss: 8.26 | Tokens per second: 7529.30 | Training tokens per second (%): 21.34 | MFU (%): 39.24 | TFLOPs: 388.07
2025-05-14 15:21:58,623 - root - INFO - Step: 310 | Loss: 7.59 | Tokens per second: 7577.75 | Training tokens per second (%): 15.84 | MFU (%): 39.49 | TFLOPs: 390.57
2025-05-14 15:22:01,407 - root - INFO - Step: 315 | Loss: 6.87 | Tokens per second: 7467.10 | Training tokens per second (%): 28.90 | MFU (%): 38.91 | TFLOPs: 384.86
2025-05-14 15:22:04,205 - root - INFO - Step: 320 | Loss: 7.61 | Tokens per second: 7427.20 | Training tokens per second (%): 31.73 | MFU (%): 38.71 | TFLOPs: 382.81
2025-05-14 15:22:06,985 - root - INFO - Step: 325 | Loss: 7.07 | Tokens per second: 7478.54 | Training tokens per second (%): 27.17 | MFU (%): 38.97 | TFLOPs: 385.45
2025-05-14 15:22:09,780 - root - INFO - Step: 330 | Loss: 6.34 | Tokens per second: 7434.62 | Training tokens per second (%): 30.51 | MFU (%): 38.75 | TFLOPs: 383.19
2025-05-14 15:22:12,485 - root - INFO - Step: 335 | Loss: 7.73 | Tokens per second: 7689.62 | Training tokens per second (%): 6.10 | MFU (%): 40.07 | TFLOPs: 396.33
2025-05-14 15:22:15,225 - root - INFO - Step: 340 | Loss: 7.40 | Tokens per second: 7587.38 | Training tokens per second (%): 16.78 | MFU (%): 39.54 | TFLOPs: 391.06
2025-05-14 15:22:17,983 - root - INFO - Step: 345 | Loss: 7.28 | Tokens per second: 7537.52 | Training tokens per second (%): 19.16 | MFU (%): 39.28 | TFLOPs: 388.49
2025-05-14 15:22:20,735 - root - INFO - Step: 350 | Loss: 7.21 | Tokens per second: 7554.98 | Training tokens per second (%): 19.25 | MFU (%): 39.37 | TFLOPs: 389.39
