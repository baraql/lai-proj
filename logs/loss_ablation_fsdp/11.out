START TIME: Thu May 22 23:27:25 CEST 2025
Node IP: 172.28.36.40
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-22 23:27:49,840 - root - INFO - Setting seed to 42
2025-05-22 23:27:49,840 - root - INFO - Setting seed to 42
2025-05-22 23:27:50,116 - root - INFO - Setting seed to 42
2025-05-22 23:27:50,116 - root - INFO - Setting seed to 42
2025-05-22 23:27:50,116 - root - INFO - [RANK 0 / 4] Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=5e-05, lr_warmup_steps=100, training_steps=100, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, scaling_factor=11, scaling_strategy=<ScalingStrategy.ALL: 'all'>, set_seed=42)
2025-05-22 23:27:50,116 - root - INFO - [RANK 0 / 4] world size: 4
2025-05-22 23:27:50,116 - root - INFO - [RANK 0 / 4] Setting up DataLoaders...
2025-05-22 23:27:54,505 - root - INFO - [RANK 0 / 4] Setting up Model...
2025-05-22 23:27:54,506 - root - INFO - [RANK 0 / 4] Loading a model with scale=11, scaling_strategy=ScalingStrategy.ALL, config:
TransformerModelArgs(dim=2816, n_layers=88, n_heads=88, n_kv_heads=8, multiple_of=256, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, norm_type='rmsnorm', seq_len=4096, vocab_size=131072)
Total model parameters: 9683573504
Total model parameters: 9683573504
Total model parameters: 9683573504
Total model parameters: 9683573504
2025-05-22 23:28:33,885 - root - INFO - [RANK 0 / 4] Wrapping model with FSDP
2025-05-22 23:28:35,619 - root - INFO - [RANK 0 / 4] The model is now: FullyShardedDataParallel
2025-05-22 23:28:35,620 - root - INFO - [rank 0] local params: 2420893376
2025-05-22 23:28:35,624 - root - INFO - [RANK 0 / 4] Starting training!
2025-05-22 23:28:35,960 - root - INFO - [rank 2] local params: 2420893376
2025-05-22 23:28:36,349 - root - INFO - [rank 3] local params: 2420893376
2025-05-22 23:28:38,181 - root - INFO - [rank 1] local params: 2420893376
2025-05-22 23:28:44,514 - root - INFO - [RANK 0 / 4] Step: 1 | Loss: 11.96 | Tokens per second: 460.76 | Training tokens per second (%): 19.38 | MFU (%): 1.24 | TFLOPs: 12.30
2025-05-22 23:28:56,656 - root - INFO - [RANK 0 / 4] Step: 5 | Loss: 11.94 | Tokens per second: 1349.40 | Training tokens per second (%): 11.41 | MFU (%): 3.64 | TFLOPs: 36.04
2025-05-22 23:29:10,769 - root - INFO - [RANK 0 / 4] Step: 10 | Loss: 11.89 | Tokens per second: 1451.24 | Training tokens per second (%): 25.72 | MFU (%): 3.92 | TFLOPs: 38.76
2025-05-22 23:29:24,841 - root - INFO - [RANK 0 / 4] Step: 15 | Loss: 11.57 | Tokens per second: 1455.40 | Training tokens per second (%): 35.21 | MFU (%): 3.93 | TFLOPs: 38.87
2025-05-22 23:29:38,809 - root - INFO - [RANK 0 / 4] Step: 20 | Loss: 11.18 | Tokens per second: 1466.34 | Training tokens per second (%): 34.78 | MFU (%): 3.96 | TFLOPs: 39.16
2025-05-22 23:29:52,792 - root - INFO - [RANK 0 / 4] Step: 25 | Loss: 10.66 | Tokens per second: 1464.64 | Training tokens per second (%): 18.28 | MFU (%): 3.95 | TFLOPs: 39.11
2025-05-22 23:30:06,897 - root - INFO - [RANK 0 / 4] Step: 30 | Loss: 9.90 | Tokens per second: 1451.98 | Training tokens per second (%): 26.99 | MFU (%): 3.92 | TFLOPs: 38.78
2025-05-22 23:30:20,945 - root - INFO - [RANK 0 / 4] Step: 35 | Loss: 9.91 | Tokens per second: 1457.99 | Training tokens per second (%): 13.78 | MFU (%): 3.94 | TFLOPs: 38.94
2025-05-22 23:30:34,813 - root - INFO - [RANK 0 / 4] Step: 40 | Loss: 10.08 | Tokens per second: 1476.80 | Training tokens per second (%): 9.95 | MFU (%): 3.99 | TFLOPs: 39.44
2025-05-22 23:30:48,791 - root - INFO - [RANK 0 / 4] Step: 45 | Loss: 9.54 | Tokens per second: 1465.26 | Training tokens per second (%): 15.59 | MFU (%): 3.96 | TFLOPs: 39.13
2025-05-22 23:31:02,750 - root - INFO - [RANK 0 / 4] Step: 50 | Loss: 9.56 | Tokens per second: 1467.16 | Training tokens per second (%): 10.93 | MFU (%): 3.96 | TFLOPs: 39.18
2025-05-22 23:31:16,678 - root - INFO - [RANK 0 / 4] Step: 55 | Loss: 9.95 | Tokens per second: 1470.46 | Training tokens per second (%): 28.32 | MFU (%): 3.97 | TFLOPs: 39.27
2025-05-22 23:31:30,667 - root - INFO - [RANK 0 / 4] Step: 60 | Loss: 9.28 | Tokens per second: 1464.03 | Training tokens per second (%): 26.71 | MFU (%): 3.95 | TFLOPs: 39.10
2025-05-22 23:31:44,664 - root - INFO - [RANK 0 / 4] Step: 65 | Loss: 9.48 | Tokens per second: 1463.28 | Training tokens per second (%): 24.18 | MFU (%): 3.95 | TFLOPs: 39.08
2025-05-22 23:31:58,618 - root - INFO - [RANK 0 / 4] Step: 70 | Loss: 8.96 | Tokens per second: 1467.70 | Training tokens per second (%): 26.25 | MFU (%): 3.96 | TFLOPs: 39.20
2025-05-22 23:32:12,544 - root - INFO - [RANK 0 / 4] Step: 75 | Loss: 8.75 | Tokens per second: 1470.71 | Training tokens per second (%): 16.89 | MFU (%): 3.97 | TFLOPs: 39.28
2025-05-22 23:32:26,508 - root - INFO - [RANK 0 / 4] Step: 80 | Loss: 8.64 | Tokens per second: 1466.74 | Training tokens per second (%): 17.36 | MFU (%): 3.96 | TFLOPs: 39.17
2025-05-22 23:32:40,520 - root - INFO - [RANK 0 / 4] Step: 85 | Loss: 8.69 | Tokens per second: 1461.65 | Training tokens per second (%): 16.04 | MFU (%): 3.95 | TFLOPs: 39.03
2025-05-22 23:32:54,472 - root - INFO - [RANK 0 / 4] Step: 90 | Loss: 8.10 | Tokens per second: 1467.86 | Training tokens per second (%): 57.98 | MFU (%): 3.96 | TFLOPs: 39.20
2025-05-22 23:33:08,403 - root - INFO - [RANK 0 / 4] Step: 95 | Loss: 7.68 | Tokens per second: 1470.24 | Training tokens per second (%): 57.90 | MFU (%): 3.97 | TFLOPs: 39.26
2025-05-22 23:33:22,381 - root - INFO - [RANK 0 / 4] Step: 100 | Loss: 7.70 | Tokens per second: 1465.21 | Training tokens per second (%): 93.89 | MFU (%): 3.96 | TFLOPs: 39.13
2025-05-22 23:33:22,381 - root - INFO - [RANK 0 / 4] Training completed
2025-05-22 23:33:22,381 - root - INFO - [RANK 0 / 4] Took 5 min 32 sec
END TIME: Thu May 22 23:33:25 CEST 2025
