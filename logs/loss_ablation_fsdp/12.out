START TIME: Thu May 22 20:26:04 CEST 2025
Node IP: 172.28.39.80
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-22 20:26:26,638 - root - INFO - Setting seed to 42
2025-05-22 20:26:26,638 - root - INFO - Setting seed to 42
2025-05-22 20:26:26,638 - root - INFO - [RANK 0 / 4] Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=5e-05, lr_warmup_steps=100, training_steps=100, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, scaling_factor=12, scaling_strategy=<ScalingStrategy.ALL: 'all'>, set_seed=42)
2025-05-22 20:26:26,638 - root - INFO - [RANK 0 / 4] world size: 4
2025-05-22 20:26:26,638 - root - INFO - [RANK 0 / 4] Setting up DataLoaders...
2025-05-22 20:26:26,638 - root - INFO - Setting seed to 42
2025-05-22 20:26:26,638 - root - INFO - Setting seed to 42
2025-05-22 20:26:29,871 - root - INFO - [RANK 0 / 4] Setting up Model...
2025-05-22 20:26:29,872 - root - INFO - [RANK 0 / 4] Loading a model with scale=12, scaling_strategy=ScalingStrategy.ALL, config:
TransformerModelArgs(dim=3072, n_layers=96, n_heads=96, n_kv_heads=8, multiple_of=256, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, norm_type='rmsnorm', seq_len=4096, vocab_size=131072)
Total model parameters: 12281515008
Total model parameters: 12281515008
2025-05-22 20:27:18,745 - root - INFO - [rank 2] local params: 3070378752
Total model parameters: 12281515008
Total model parameters: 12281515008
2025-05-22 20:27:19,717 - root - INFO - [RANK 0 / 4] Wrapping model with FSDP
2025-05-22 20:27:20,400 - root - INFO - [rank 1] local params: 3070378752
2025-05-22 20:27:20,447 - root - INFO - [RANK 0 / 4] The model is now: FullyShardedDataParallel
2025-05-22 20:27:20,448 - root - INFO - [rank 0] local params: 3070378752
2025-05-22 20:27:20,452 - root - INFO - [RANK 0 / 4] Starting training!
2025-05-22 20:27:21,969 - root - INFO - [rank 3] local params: 3070378752
2025-05-22 20:27:29,172 - root - INFO - [RANK 0 / 4] Step: 1 | Loss: 11.95 | Tokens per second: 469.80 | Training tokens per second (%): 19.38 | MFU (%): 1.56 | TFLOPs: 15.46
2025-05-22 20:27:43,017 - root - INFO - [RANK 0 / 4] Step: 5 | Loss: 11.92 | Tokens per second: 1183.38 | Training tokens per second (%): 11.41 | MFU (%): 3.94 | TFLOPs: 38.95
2025-05-22 20:28:00,319 - root - INFO - [RANK 0 / 4] Step: 10 | Loss: 11.85 | Tokens per second: 1183.76 | Training tokens per second (%): 25.72 | MFU (%): 3.94 | TFLOPs: 38.97
2025-05-22 20:28:17,819 - root - INFO - [RANK 0 / 4] Step: 15 | Loss: 11.43 | Tokens per second: 1170.30 | Training tokens per second (%): 35.21 | MFU (%): 3.90 | TFLOPs: 38.52
2025-05-22 20:28:35,104 - root - INFO - [RANK 0 / 4] Step: 20 | Loss: 11.03 | Tokens per second: 1184.85 | Training tokens per second (%): 34.78 | MFU (%): 3.94 | TFLOPs: 39.00
2025-05-22 20:28:52,364 - root - INFO - [RANK 0 / 4] Step: 25 | Loss: 10.53 | Tokens per second: 1186.62 | Training tokens per second (%): 18.28 | MFU (%): 3.95 | TFLOPs: 39.06
2025-05-22 20:29:09,699 - root - INFO - [RANK 0 / 4] Step: 30 | Loss: 9.73 | Tokens per second: 1181.47 | Training tokens per second (%): 26.99 | MFU (%): 3.93 | TFLOPs: 38.89
2025-05-22 20:29:26,999 - root - INFO - [RANK 0 / 4] Step: 35 | Loss: 9.83 | Tokens per second: 1183.81 | Training tokens per second (%): 13.78 | MFU (%): 3.94 | TFLOPs: 38.97
2025-05-22 20:29:44,291 - root - INFO - [RANK 0 / 4] Step: 40 | Loss: 9.99 | Tokens per second: 1184.43 | Training tokens per second (%): 9.95 | MFU (%): 3.94 | TFLOPs: 38.99
2025-05-22 20:30:01,671 - root - INFO - [RANK 0 / 4] Step: 45 | Loss: 9.47 | Tokens per second: 1178.41 | Training tokens per second (%): 15.59 | MFU (%): 3.92 | TFLOPs: 38.79
2025-05-22 20:30:19,041 - root - INFO - [RANK 0 / 4] Step: 50 | Loss: 9.49 | Tokens per second: 1179.09 | Training tokens per second (%): 10.93 | MFU (%): 3.92 | TFLOPs: 38.81
2025-05-22 20:30:36,392 - root - INFO - [RANK 0 / 4] Step: 55 | Loss: 9.74 | Tokens per second: 1180.37 | Training tokens per second (%): 28.32 | MFU (%): 3.93 | TFLOPs: 38.86
2025-05-22 20:30:53,819 - root - INFO - [RANK 0 / 4] Step: 60 | Loss: 9.18 | Tokens per second: 1175.21 | Training tokens per second (%): 26.71 | MFU (%): 3.91 | TFLOPs: 38.69
2025-05-22 20:31:11,052 - root - INFO - [RANK 0 / 4] Step: 65 | Loss: 9.38 | Tokens per second: 1188.43 | Training tokens per second (%): 24.18 | MFU (%): 3.96 | TFLOPs: 39.12
2025-05-22 20:31:28,307 - root - INFO - [RANK 0 / 4] Step: 70 | Loss: 8.85 | Tokens per second: 1186.96 | Training tokens per second (%): 26.25 | MFU (%): 3.95 | TFLOPs: 39.07
2025-05-22 20:31:45,601 - root - INFO - [RANK 0 / 4] Step: 75 | Loss: 8.65 | Tokens per second: 1184.26 | Training tokens per second (%): 16.89 | MFU (%): 3.94 | TFLOPs: 38.98
2025-05-22 20:32:02,861 - root - INFO - [RANK 0 / 4] Step: 80 | Loss: 8.61 | Tokens per second: 1186.56 | Training tokens per second (%): 17.36 | MFU (%): 3.95 | TFLOPs: 39.06
2025-05-22 20:32:20,210 - root - INFO - [RANK 0 / 4] Step: 85 | Loss: 8.63 | Tokens per second: 1180.56 | Training tokens per second (%): 16.04 | MFU (%): 3.93 | TFLOPs: 38.86
2025-05-22 20:32:37,458 - root - INFO - [RANK 0 / 4] Step: 90 | Loss: 8.02 | Tokens per second: 1187.38 | Training tokens per second (%): 57.98 | MFU (%): 3.95 | TFLOPs: 39.09
2025-05-22 20:32:54,761 - root - INFO - [RANK 0 / 4] Step: 95 | Loss: 7.63 | Tokens per second: 1183.67 | Training tokens per second (%): 57.90 | MFU (%): 3.94 | TFLOPs: 38.96
2025-05-22 20:33:12,062 - root - INFO - [RANK 0 / 4] Step: 100 | Loss: 7.63 | Tokens per second: 1183.75 | Training tokens per second (%): 93.89 | MFU (%): 3.94 | TFLOPs: 38.97
2025-05-22 20:33:12,063 - root - INFO - [RANK 0 / 4] Training completed
2025-05-22 20:33:12,063 - root - INFO - [RANK 0 / 4] Took 6 min 45 sec
END TIME: Thu May 22 20:33:18 CEST 2025
