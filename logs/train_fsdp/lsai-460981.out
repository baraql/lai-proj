START TIME: Fri May 23 18:32:52 CEST 2025
Node IP: 172.28.39.32
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-23 18:33:15,024 - root - INFO - [RANK 0 / 16] Setting seed to 42
2025-05-23 18:33:15,024 - root - INFO - [RANK 0 / 16] AVAILABLE GPUS: 16
2025-05-23 18:33:15,024 - root - INFO - [RANK 0 / 16] NODES: 4.0
2025-05-23 18:33:15,024 - root - INFO - [RANK 0 / 16] Total RAM: 854.46 GB
2025-05-23 18:33:15,024 - root - INFO - [RANK 0 / 16] Available RAM: 774.74 GB
2025-05-23 18:33:15,024 - root - INFO - [RANK 0 / 16] Available per-process RAM: 193.68 GB
2025-05-23 18:33:21,809 - root - INFO - [RANK 0 / 16] GPU 0: NVIDIA GH200 120GB
2025-05-23 18:33:21,809 - root - INFO - [RANK 0 / 16]   Total memory: 94.50 GB
2025-05-23 18:33:21,809 - root - INFO - [RANK 0 / 16]   Allocated memory: 0.00 GB
2025-05-23 18:33:21,809 - root - INFO - [RANK 0 / 16]   Cached memory: 0.00 GB
2025-05-23 18:33:21,809 - root - INFO - [RANK 0 / 16] Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=5e-05, lr_warmup_steps=100, training_steps=100, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=False, scaling_factor=10, scaling_strategy=<ScalingStrategy.ALL: 'all'>, set_seed=42)
2025-05-23 18:33:21,809 - root - INFO - [RANK 0 / 16] world size: 16
2025-05-23 18:33:21,809 - root - INFO - [RANK 0 / 16] Setting up DataLoaders...
2025-05-23 18:33:24,596 - root - INFO - [RANK 0 / 16] Setting up Model...
2025-05-23 18:33:24,596 - root - INFO - [RANK 0 / 16] Loading a model with scale=10, scaling_strategy=ScalingStrategy.ALL, config:
TransformerModelArgs(dim=2560, n_layers=80, n_heads=80, n_kv_heads=8, multiple_of=256, ffn_dim_multiplier=1.3, norm_eps=1e-05, rope_theta=500000, norm_type='rmsnorm', seq_len=4096, vocab_size=131072)
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
Total model parameters: 7329958400
2025-05-23 18:33:54,101 - root - INFO - [rank 4] local params: 458122400
Total model parameters: 7329958400
2025-05-23 18:33:54,245 - root - INFO - [rank 6] local params: 458122400
2025-05-23 18:33:54,289 - root - INFO - [rank 10] local params: 458122400
2025-05-23 18:33:54,289 - root - INFO - [rank 9] local params: 458122400
2025-05-23 18:33:54,491 - root - INFO - [rank 3] local params: 458122400
2025-05-23 18:33:54,500 - root - INFO - [rank 1] local params: 458122400
2025-05-23 18:33:54,500 - root - INFO - [rank 2] local params: 458122400
2025-05-23 18:33:54,542 - root - INFO - [rank 13] local params: 458122400
2025-05-23 18:33:54,542 - root - INFO - [rank 14] local params: 458122400
Total model parameters: 7329958400
2025-05-23 18:33:54,587 - root - INFO - [rank 15] local params: 458122400
2025-05-23 18:33:54,661 - root - INFO - [rank 8] local params: 458122400
Total model parameters: 7329958400
2025-05-23 18:33:55,235 - root - INFO - [rank 11] local params: 458122400
Total model parameters: 7329958400
Total model parameters: 7329958400
2025-05-23 18:33:55,371 - root - INFO - [RANK 0 / 16] Wrapping model with FSDP
2025-05-23 18:33:55,725 - root - INFO - [rank 5] local params: 458122400
2025-05-23 18:33:55,790 - root - INFO - [rank 12] local params: 458122400
2025-05-23 18:33:55,851 - root - INFO - [RANK 0 / 16] The model is now: FullyShardedDataParallel
2025-05-23 18:33:55,852 - root - INFO - [rank 0] local params: 458122400
2025-05-23 18:33:55,856 - root - INFO - [RANK 0 / 16] Starting training!
2025-05-23 18:33:59,173 - root - INFO - [rank 7] local params: 458122400
2025-05-23 18:34:06,189 - root - INFO - [RANK 0 / 16] Step: 1 | Loss: 11.93 | Tokens per second: 396.43 | Training tokens per second (%): 19.38 | MFU (%): 0.51 | TFLOPs: 5.08
2025-05-23 18:34:13,430 - root - INFO - [RANK 0 / 16] Step: 5 | Loss: 11.97 | Tokens per second: 2262.78 | Training tokens per second (%): 11.41 | MFU (%): 2.93 | TFLOPs: 29.00
2025-05-23 18:34:23,119 - root - INFO - [RANK 0 / 16] Step: 10 | Loss: 11.92 | Tokens per second: 2113.69 | Training tokens per second (%): 25.72 | MFU (%): 2.74 | TFLOPs: 27.09
2025-05-23 18:34:32,987 - root - INFO - [RANK 0 / 16] Step: 15 | Loss: 11.61 | Tokens per second: 2075.50 | Training tokens per second (%): 35.21 | MFU (%): 2.69 | TFLOPs: 26.60
2025-05-23 18:34:42,400 - root - INFO - [RANK 0 / 16] Step: 20 | Loss: 11.30 | Tokens per second: 2175.97 | Training tokens per second (%): 34.78 | MFU (%): 2.82 | TFLOPs: 27.89
2025-05-23 18:34:51,599 - root - INFO - [RANK 0 / 16] Step: 25 | Loss: 10.83 | Tokens per second: 2226.32 | Training tokens per second (%): 18.28 | MFU (%): 2.88 | TFLOPs: 28.53
2025-05-23 18:35:00,693 - root - INFO - [RANK 0 / 16] Step: 30 | Loss: 10.06 | Tokens per second: 2252.27 | Training tokens per second (%): 26.99 | MFU (%): 2.92 | TFLOPs: 28.86
2025-05-23 18:35:09,853 - root - INFO - [RANK 0 / 16] Step: 35 | Loss: 10.04 | Tokens per second: 2235.70 | Training tokens per second (%): 13.78 | MFU (%): 2.90 | TFLOPs: 28.65
2025-05-23 18:35:18,917 - root - INFO - [RANK 0 / 16] Step: 40 | Loss: 10.16 | Tokens per second: 2259.62 | Training tokens per second (%): 9.95 | MFU (%): 2.93 | TFLOPs: 28.96
2025-05-23 18:35:28,043 - root - INFO - [RANK 0 / 16] Step: 45 | Loss: 9.67 | Tokens per second: 2244.24 | Training tokens per second (%): 15.59 | MFU (%): 2.91 | TFLOPs: 28.76
2025-05-23 18:35:37,332 - root - INFO - [RANK 0 / 16] Step: 50 | Loss: 9.66 | Tokens per second: 2204.95 | Training tokens per second (%): 10.93 | MFU (%): 2.86 | TFLOPs: 28.26
2025-05-23 18:35:46,615 - root - INFO - [RANK 0 / 16] Step: 55 | Loss: 10.03 | Tokens per second: 2206.18 | Training tokens per second (%): 28.32 | MFU (%): 2.86 | TFLOPs: 28.27
2025-05-23 18:35:55,932 - root - INFO - [RANK 0 / 16] Step: 60 | Loss: 9.37 | Tokens per second: 2198.30 | Training tokens per second (%): 26.71 | MFU (%): 2.85 | TFLOPs: 28.17
2025-05-23 18:36:05,149 - root - INFO - [RANK 0 / 16] Step: 65 | Loss: 9.58 | Tokens per second: 2222.04 | Training tokens per second (%): 24.18 | MFU (%): 2.88 | TFLOPs: 28.48
2025-05-23 18:36:14,499 - root - INFO - [RANK 0 / 16] Step: 70 | Loss: 9.07 | Tokens per second: 2190.53 | Training tokens per second (%): 26.25 | MFU (%): 2.84 | TFLOPs: 28.07
2025-05-23 18:36:23,571 - root - INFO - [RANK 0 / 16] Step: 75 | Loss: 8.88 | Tokens per second: 2257.62 | Training tokens per second (%): 16.89 | MFU (%): 2.93 | TFLOPs: 28.93
2025-05-23 18:36:32,786 - root - INFO - [RANK 0 / 16] Step: 80 | Loss: 8.78 | Tokens per second: 2222.48 | Training tokens per second (%): 17.36 | MFU (%): 2.88 | TFLOPs: 28.48
2025-05-23 18:36:41,692 - root - INFO - [RANK 0 / 16] Step: 85 | Loss: 8.81 | Tokens per second: 2299.69 | Training tokens per second (%): 16.04 | MFU (%): 2.98 | TFLOPs: 29.47
2025-05-23 18:36:51,073 - root - INFO - [RANK 0 / 16] Step: 90 | Loss: 8.17 | Tokens per second: 2183.39 | Training tokens per second (%): 57.98 | MFU (%): 2.83 | TFLOPs: 27.98
2025-05-23 18:37:00,540 - root - INFO - [RANK 0 / 16] Step: 95 | Loss: 7.78 | Tokens per second: 2163.35 | Training tokens per second (%): 57.90 | MFU (%): 2.80 | TFLOPs: 27.72
2025-05-23 18:37:09,963 - root - INFO - [RANK 0 / 16] Step: 100 | Loss: 7.82 | Tokens per second: 2173.41 | Training tokens per second (%): 93.89 | MFU (%): 2.82 | TFLOPs: 27.85
2025-05-23 18:37:09,964 - root - INFO - [RANK 0 / 16] Training completed
2025-05-23 18:37:09,964 - root - INFO - [RANK 0 / 16] Took 3 min 48 sec
END TIME: Fri May 23 18:37:19 CEST 2025
