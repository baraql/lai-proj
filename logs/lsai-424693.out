START TIME: Fri May  9 14:49:04 CEST 2025
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-09 14:49:23,187 - root - INFO - Experiment args: Namespace(dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=True)
2025-05-09 14:49:23,188 - root - INFO - Setting up DataLoaders...
2025-05-09 14:49:26,635 - root - INFO - Setting up Model...
2025-05-09 14:50:05,151 - root - INFO - Using `torch.compile`
2025-05-09 14:50:05,226 - root - INFO - Starting training!
/usr/local/lib/python3.12/dist-packages/torch/_inductor/lowering.py:1782: UserWarning: Torchinductor does not support code generation for complex operators. Performance may be worse than eager.
  warnings.warn(
2025-05-09 14:50:41,097 - root - INFO - Step: 1 | Loss: 11.96 | Tokens per second: 114.32 | Training tokens per second (%): 19.38 | MFU (%): 0.63 | TFLOPs: 6.26
2025-05-09 14:50:43,102 - root - INFO - Step: 5 | Loss: 11.89 | Tokens per second: 8344.50 | Training tokens per second (%): 11.41 | MFU (%): 46.20 | TFLOPs: 456.97
2025-05-09 14:50:45,652 - root - INFO - Step: 10 | Loss: 11.77 | Tokens per second: 8160.96 | Training tokens per second (%): 25.72 | MFU (%): 45.19 | TFLOPs: 446.91
2025-05-09 14:50:48,237 - root - INFO - Step: 15 | Loss: 11.32 | Tokens per second: 8052.51 | Training tokens per second (%): 35.21 | MFU (%): 44.59 | TFLOPs: 440.98
2025-05-09 14:50:50,812 - root - INFO - Step: 20 | Loss: 10.86 | Tokens per second: 8080.62 | Training tokens per second (%): 34.78 | MFU (%): 44.74 | TFLOPs: 442.51
2025-05-09 14:50:53,332 - root - INFO - Step: 25 | Loss: 10.58 | Tokens per second: 8263.22 | Training tokens per second (%): 18.28 | MFU (%): 45.75 | TFLOPs: 452.51
2025-05-09 14:50:55,892 - root - INFO - Step: 30 | Loss: 9.81 | Tokens per second: 8129.57 | Training tokens per second (%): 26.99 | MFU (%): 45.01 | TFLOPs: 445.20
2025-05-09 14:50:58,403 - root - INFO - Step: 35 | Loss: 9.89 | Tokens per second: 8290.69 | Training tokens per second (%): 13.78 | MFU (%): 45.91 | TFLOPs: 454.02
2025-05-09 14:51:00,907 - root - INFO - Step: 40 | Loss: 10.15 | Tokens per second: 8316.49 | Training tokens per second (%): 9.95 | MFU (%): 46.05 | TFLOPs: 455.43
2025-05-09 14:51:03,424 - root - INFO - Step: 45 | Loss: 9.55 | Tokens per second: 8269.76 | Training tokens per second (%): 15.59 | MFU (%): 45.79 | TFLOPs: 452.87
2025-05-09 14:51:05,920 - root - INFO - Step: 50 | Loss: 9.59 | Tokens per second: 8343.67 | Training tokens per second (%): 10.93 | MFU (%): 46.20 | TFLOPs: 456.92
2025-05-09 14:51:08,486 - root - INFO - Step: 55 | Loss: 10.03 | Tokens per second: 8111.10 | Training tokens per second (%): 28.32 | MFU (%): 44.91 | TFLOPs: 444.18
2025-05-09 14:51:11,044 - root - INFO - Step: 60 | Loss: 9.61 | Tokens per second: 8134.96 | Training tokens per second (%): 26.71 | MFU (%): 45.04 | TFLOPs: 445.49
2025-05-09 14:51:13,591 - root - INFO - Step: 65 | Loss: 9.93 | Tokens per second: 8172.63 | Training tokens per second (%): 24.18 | MFU (%): 45.25 | TFLOPs: 447.55
2025-05-09 14:51:16,142 - root - INFO - Step: 70 | Loss: 9.58 | Tokens per second: 8159.06 | Training tokens per second (%): 26.25 | MFU (%): 45.18 | TFLOPs: 446.81
2025-05-09 14:51:18,670 - root - INFO - Step: 75 | Loss: 9.36 | Tokens per second: 8235.54 | Training tokens per second (%): 16.89 | MFU (%): 45.60 | TFLOPs: 451.00
2025-05-09 14:51:21,194 - root - INFO - Step: 80 | Loss: 9.32 | Tokens per second: 8247.83 | Training tokens per second (%): 17.36 | MFU (%): 45.67 | TFLOPs: 451.67
2025-05-09 14:51:23,713 - root - INFO - Step: 85 | Loss: 9.51 | Tokens per second: 8266.10 | Training tokens per second (%): 16.04 | MFU (%): 45.77 | TFLOPs: 452.67
2025-05-09 14:51:26,382 - root - INFO - Step: 90 | Loss: 9.02 | Tokens per second: 7793.99 | Training tokens per second (%): 57.98 | MFU (%): 43.16 | TFLOPs: 426.82
2025-05-09 14:51:29,042 - root - INFO - Step: 95 | Loss: 8.71 | Tokens per second: 7819.87 | Training tokens per second (%): 57.90 | MFU (%): 43.30 | TFLOPs: 428.23
2025-05-09 14:51:31,822 - root - INFO - Step: 100 | Loss: 8.92 | Tokens per second: 7476.45 | Training tokens per second (%): 93.89 | MFU (%): 41.40 | TFLOPs: 409.43
2025-05-09 14:51:34,348 - root - INFO - Step: 105 | Loss: 9.17 | Tokens per second: 8241.41 | Training tokens per second (%): 17.91 | MFU (%): 45.63 | TFLOPs: 451.32
2025-05-09 14:51:36,895 - root - INFO - Step: 110 | Loss: 9.28 | Tokens per second: 8173.56 | Training tokens per second (%): 25.76 | MFU (%): 45.26 | TFLOPs: 447.60
2025-05-09 14:51:39,388 - root - INFO - Step: 115 | Loss: 9.13 | Tokens per second: 8349.84 | Training tokens per second (%): 9.98 | MFU (%): 46.23 | TFLOPs: 457.26
2025-05-09 14:51:41,941 - root - INFO - Step: 120 | Loss: 8.98 | Tokens per second: 8154.63 | Training tokens per second (%): 26.43 | MFU (%): 45.15 | TFLOPs: 446.57
2025-05-09 14:51:44,488 - root - INFO - Step: 125 | Loss: 9.27 | Tokens per second: 8170.90 | Training tokens per second (%): 24.73 | MFU (%): 45.24 | TFLOPs: 447.46
2025-05-09 14:51:47,015 - root - INFO - Step: 130 | Loss: 9.59 | Tokens per second: 8238.85 | Training tokens per second (%): 17.81 | MFU (%): 45.62 | TFLOPs: 451.18
2025-05-09 14:51:49,552 - root - INFO - Step: 135 | Loss: 8.85 | Tokens per second: 8204.90 | Training tokens per second (%): 21.95 | MFU (%): 45.43 | TFLOPs: 449.32
2025-05-09 14:51:52,059 - root - INFO - Step: 140 | Loss: 8.85 | Tokens per second: 8304.16 | Training tokens per second (%): 11.89 | MFU (%): 45.98 | TFLOPs: 454.76
2025-05-09 14:51:54,613 - root - INFO - Step: 145 | Loss: 8.70 | Tokens per second: 8150.69 | Training tokens per second (%): 26.10 | MFU (%): 45.13 | TFLOPs: 446.35
2025-05-09 14:51:57,143 - root - INFO - Step: 150 | Loss: 8.96 | Tokens per second: 8228.91 | Training tokens per second (%): 19.74 | MFU (%): 45.56 | TFLOPs: 450.64
2025-05-09 14:51:59,738 - root - INFO - Step: 155 | Loss: 8.89 | Tokens per second: 8018.09 | Training tokens per second (%): 37.10 | MFU (%): 44.40 | TFLOPs: 439.09
2025-05-09 14:52:02,284 - root - INFO - Step: 160 | Loss: 8.22 | Tokens per second: 8177.63 | Training tokens per second (%): 22.84 | MFU (%): 45.28 | TFLOPs: 447.83
2025-05-09 14:52:04,826 - root - INFO - Step: 165 | Loss: 8.60 | Tokens per second: 8186.48 | Training tokens per second (%): 26.44 | MFU (%): 45.33 | TFLOPs: 448.31
2025-05-09 14:52:07,425 - root - INFO - Step: 170 | Loss: 9.01 | Tokens per second: 8008.23 | Training tokens per second (%): 39.34 | MFU (%): 44.34 | TFLOPs: 438.55
2025-05-09 14:52:09,955 - root - INFO - Step: 175 | Loss: 8.80 | Tokens per second: 8226.23 | Training tokens per second (%): 19.59 | MFU (%): 45.55 | TFLOPs: 450.49
2025-05-09 14:52:12,473 - root - INFO - Step: 180 | Loss: 8.55 | Tokens per second: 8270.21 | Training tokens per second (%): 14.69 | MFU (%): 45.79 | TFLOPs: 452.90
2025-05-09 14:52:14,985 - root - INFO - Step: 185 | Loss: 8.87 | Tokens per second: 8285.79 | Training tokens per second (%): 13.71 | MFU (%): 45.88 | TFLOPs: 453.75
2025-05-09 14:52:17,524 - root - INFO - Step: 190 | Loss: 8.51 | Tokens per second: 8200.88 | Training tokens per second (%): 21.21 | MFU (%): 45.41 | TFLOPs: 449.10
2025-05-09 14:52:20,121 - root - INFO - Step: 195 | Loss: 8.51 | Tokens per second: 8010.87 | Training tokens per second (%): 42.67 | MFU (%): 44.36 | TFLOPs: 438.69
2025-05-09 14:52:22,641 - root - INFO - Step: 200 | Loss: 8.75 | Tokens per second: 8261.52 | Training tokens per second (%): 16.92 | MFU (%): 45.75 | TFLOPs: 452.42
2025-05-09 14:52:25,130 - root - INFO - Step: 205 | Loss: 7.77 | Tokens per second: 8365.16 | Training tokens per second (%): 9.70 | MFU (%): 46.32 | TFLOPs: 458.10
2025-05-09 14:52:27,659 - root - INFO - Step: 210 | Loss: 8.57 | Tokens per second: 8233.32 | Training tokens per second (%): 19.35 | MFU (%): 45.59 | TFLOPs: 450.88
2025-05-09 14:52:30,163 - root - INFO - Step: 215 | Loss: 8.39 | Tokens per second: 8314.51 | Training tokens per second (%): 12.01 | MFU (%): 46.04 | TFLOPs: 455.32
2025-05-09 14:52:32,666 - root - INFO - Step: 220 | Loss: 8.65 | Tokens per second: 8318.11 | Training tokens per second (%): 12.01 | MFU (%): 46.06 | TFLOPs: 455.52
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 424693.0 ON nid006452 CANCELLED AT 2025-05-09T14:52:33 ***
slurmstepd: error: *** JOB 424693 ON nid006452 CANCELLED AT 2025-05-09T14:52:33 ***
srun: forcing job termination
srun: got SIGCONT
